<!DOCTYPE html>
<html lang="en" data-theme="light"><head>
    <title>批处理 · HZW</title>
    <meta charset="utf-8">
    
    <meta name="generator" content="Hugo 0.124.1">
    <meta property="og:title" content="批处理" />
<meta property="og:description" content="a note for learning 批处理" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://seconsorl.github.io/post/%E6%89%B9%E5%A4%84%E7%90%86/" /><meta property="og:image" content="https://seconsorl.github.io/images/profile.png" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2024-05-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-05-06T00:00:00+00:00" /><meta property="og:site_name" content="A junior from NBU" />



    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description" content="HZW">
    
    
    
    <link rel="stylesheet" type="text/css" href="https://seconsorl.github.io/css/style.min.565d8c479597aa43658922d4b31e286529a7525a22c9546fa1018fc5e5ef6d86.css" integrity="sha256-Vl2MR5WXqkNliSLUsx4oZSmnUloiyVRvoQGPxeXvbYY=" crossorigin="anonymous" type="text/css">

    
    
    
    <script type="text/javascript" src="https://seconsorl.github.io/js/heyo-header.min.a3fa728a9f57833a31dfb45c48caaf1e4890c8c97f07bd7133fc2359745edb5d.js" integrity="sha256-o/pyip9Xgzox37RcSMqvHkiQyMl/B71xM/wjWXRe210=" crossorigin="anonymous"></script>

    
    
    <link rel="stylesheet" type="text/css" href="https://seconsorl.github.io/css/fonts.9398921f2d404983c2b7f9a68ddc72e3f5e58a3e38b0a8e4a70d75c12ebfb7c5.css" integrity="sha256-k5iSHy1ASYPCt/mmjdxy4/Xlij44sKjkpw11wS6/t8U=" crossorigin="anonymous">

    
    
    
    <script type="text/javascript" src="https://seconsorl.github.io/js/sidebar-toc.min.788b639e2ec681549740b90b3b865d5f9e1789e3ca9c06ccc45d65655434c954.js" integrity="sha256-eItjni7GgVSXQLkLO4ZdX54XiePKnAbMxF1lZVQ0yVQ=" crossorigin="anonymous"></script>

    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.min.js" defer></script>

        
        
        <script type="text/javascript" src="https://seconsorl.github.io/js/sketch-graph.26b92ed9317bdc6f35642d588bdf3283f40998846e01cf4bee22a126907fbf3b.js" integrity="sha256-Jrku2TF73G81ZC1Yi98yg/QJmIRuAc9L7iKhJpB/vzs=" crossorigin="anonymous" defer></script>

        
        
        <script type="text/javascript" src="https://seconsorl.github.io/js/sketch-digitalRain.af8a7b5c4428cc62d5bf49bf2698d4112c2459ee0c22c1c753ab304aef69888a.js" integrity="sha256-r4p7XEQozGLVv0m/JpjUESwkWe4MIsHHU6swSu9piIo=" crossorigin="anonymous" defer></script>

        
        
        <script type="text/javascript" src="https://seconsorl.github.io/js/sketch-circleBrushStrokes.fe8fc3ee52e1d90e9236be8c36a27711efa024beb4da304829f95dfbb61d6e84.js" integrity="sha256-/o/D7lLh2Q6SNr6MNqJ3Ee&#43;gJL602jBIKfld&#43;7YdboQ=" crossorigin="anonymous" defer></script>

        
        
        <script type="text/javascript" src="https://seconsorl.github.io/js/sketch-meta.71b5202ea881c86ac19e4b55414656a5444204a4ba08ff7368a5aa99c0a60949.js" integrity="sha256-cbUgLqiByGrBnktVQUZWpURCBKS6CP9zaKWqmcCmCUk=" crossorigin="anonymous" defer></script>

        
        
        <script type="text/javascript" src="https://seconsorl.github.io/js/sidebar-sketch.min.2e95015880993ef9abcad62d111decea22406616931bce193254bf8af2339953.js" integrity="sha256-LpUBWICZPvmrytYtER3s6iJAZhaTG84ZMlS/ivIzmVM=" crossorigin="anonymous" defer></script>
    
    
    
    <link rel="shortcut icon" href="https://seconsorl.github.io/favicons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="https://seconsorl.github.io/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://seconsorl.github.io/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://seconsorl.github.io/favicons/favicon-16x16.png">
    <link rel="canonical" href="https://seconsorl.github.io/post/%E6%89%B9%E5%A4%84%E7%90%86/">
    
    
    
    
    

    
    <meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://seconsorl.github.io/images/profile.png" /><meta name="twitter:title" content="批处理"/>
<meta name="twitter:description" content="a note for learning 批处理"/>

</head><body>
        <div class="main">
            <div class="page-top">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    <ul class="nav" id="navMenu">
        
        
            
            <li><a  href="/"  title="">Home</a></li>
        
            
            <li><a  href="/post/"  title="">Posts</a></li>
        
            
            <li><a  href="/about/"  title="">About</a></li>
        
        <li class="grow"></li>
        
        <li>
            <a class="theme-switch" title="Switch Theme">
                <i class="fa fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>
            <div class="sidebar" id="sidebar">
    <div class="top-toc">
        <img src="https://seconsorl.github.io/images/profile.png" alt="profile picture">
        
        <a href="/">A junior from NBU</a>
    </div>
    
    <div class="middle-sidebar grow" id="middle-sidebar">
        
            
            
                
            

            
        
    </div>

    <div class="footer">
        <ul class="social-links">
            
            <li>
                <a href="https://linkedin.com/" target="_blank" rel="noopener noreferrer" rel="me" aria-label="Linkedin">
                    <i class="fab fa-linkedin" aria-hidden="true"></i>
                </a>
            </li>
            
            <li>
                <a href="https://github.com/SeConSorL" target="_blank" rel="noopener noreferrer" rel="me" aria-label="GitHub">
                    <i class="fab fa-github" aria-hidden="true"></i>
                </a>
            </li>
            
            <li>
                <a href="https://www.instagram.com/" target="_blank" rel="noopener noreferrer" rel="me" aria-label="instagram">
                    <i class="fab fa-instagram" aria-hidden="true"></i>
                </a>
            </li>
            
            <li>
                <a href="mailto:216002917@nbu.edu.cn" target="_blank" rel="noopener noreferrer" rel="me" aria-label="e-mail">
                    <i class="fas fa-envelope" aria-hidden="true"></i>
                </a>
            </li>
            
        </ul>

        <div class="by">by HZW <b>·</b> 2024</div>
    </div>
</div>
            <div class="content">
<div class="post">
    
    <div class="post-title">
        <h1>批处理</h1>
        
            <div class="post-header">
    <div style="padding-top: 10px;">
        <i class="far fa-calendar"></i><span class="date">May 6, 2024</span>
        <i class="far fa-clock"></i><span class="reading-time">2 minutes</span>
        


    </div>
</div>
        
    </div>
    <div class="post-content">
        <h2 id="介绍">介绍</h2>
<h3 id="批处理">批处理</h3>
<p><strong>批处理(Batch)</strong>，也称为批处理脚本。顾名思义，批处理就是对某对象进行批量的处理，通常被认为是一种<strong>简化的脚本语言</strong>，也称作<strong>宏</strong>。在计算机系统还是DOS（磁盘操作系统是一种早期的命令行操作系统）时期时被大量使用。它应用于DOS和Windows系统中，由DOS或者Windows系统内嵌的<strong>命令解释器</strong>（通常是COMMAND. COM或者CMD.EXE）解释运行。批处理文件的扩展名为<strong>bat</strong> 、<strong>cmd</strong>。比较常见的批处理包含两类：DOS批处理和PS批处理。</p>
<p>PS批处理是基于微软的PowerShell的，用来批量处理一些任务的脚本；而DOS批处理则是基于DOS命令的，用来自动地批量地执行DOS命令以实现特定操作的脚本。</p>
<p>更复杂的情况，需要使用if、for、goto等命令控制程式的运行过程，如同C、Basic等高级语言一样。如果需要实现更复杂的应用，利用外部程式是必要的，这包括系统本身提供的外部命令和第三方提供的工具或者软件。</p>
<p>批处理程序虽然是在命令行环境中运行，但不仅仅能使用命令行软件，<strong>任何当前系统下可运行的程序都可以放在批处理文件中运行</strong>。</p>
<p>有些人认为批处理语言的含义要比上面的描述更广泛，还包括许多软件自带的批处理语言，如 Microsoft Office、Visual Studio、Adobe Photoshop所内置的批处理语言的功能，用户可通过它们让相应的软件执行自动化操作（例如调整某个资料夹所有 PSD 图档的解析度）。 而这类批处理语言也大多提供把一系列操作录制为批处理文件的功能，这样用户不必写程式就能得到批处理程序。</p>
<p>在Windows NT以后的平台中，还加入了以<code>.cmd</code>为扩展名的批处理文件，其性能比.bat文件更加优越</p>
<p><strong>运行流程</strong>：系统在解释运行批处理程序时，首先扫描整个批处理程序，然后从第一行代码开始向下逐句执行所有的命令，直至程序结尾或遇见exit命令或出错意外退出。</p>
<h3 id="windows中的bat">Windows中的BAT</h3>
<p><code>C:/</code>盘根目录下的<code>AUTOEXEC.BAT</code>批处理文件是自动运行批处理文件，<strong>每次系统启动时会自动运行该文件</strong>，即开机自启动你可以将系统每次启动时都要运行的命令放入该文件中，例如设置搜索路径，调入鼠标驱动和磁盘缓存，设置系统环境变量等。</p>
<h2 id="bat">BAT</h2>
<h3 id="变量">变量</h3>
<p><strong>类型</strong></p>
<p>批处理中的变量可以储存各种各样的数据。</p>
<p>不过用来计算时，会发现变量类型转为了int，数值的极端范围为[-2147483648，2147483647]。</p>
<p>如果不拿来计算的话，数万位也是可以的</p>
<p><strong>命名</strong></p>
<p>批处理的变量命名没有什么限制，数字 字母 甚至汉字都可以变成变量名</p>
<p><strong>扩展</strong></p>
<p>扩展，可以理解为显示出这个的值。如果想要使用这个变量的值一般情况下都要扩展。扩展用<code>%&lt;var&gt;%</code>，用<code>%</code>包围变量</p>
<p><strong>参数</strong></p>
<p>参数在批处理的表达是<code>%0</code>、<code>%1</code>、<code>%2</code> 、&hellip;、<code>%9</code>，以及全部参数<code>%*</code>（<code>%*</code>不会包括<code>%0</code>）</p>
<p><code>%0</code>的初始量是批处理本身路径；一般只能取前九个参数，除非使用<code>%*</code></p>
<p><code>shift</code>命令允许你获取后面的参数，其格式为<code>shift [/n]</code>。<code>shift</code> 会使<code>%0</code>变成<code>%1</code>，<code>%1</code>变成<code>%2</code>，……，<code>%9</code>变成原来的第10个参数；<code>shift /1</code>会从<code>%1</code>开始替换，保留原<code>%0</code></p>
<p><strong><code>~</code>的用法</strong>：<code>%~1</code>：当参数以引号开头时，<code>%~1</code>会自动将引号删除。</p>
<p><strong>特殊变量</strong></p>
<p><code>%CD%</code> - 扩展到当前目录字符串。</p>
<p><code>%DATE%</code> - 用跟 DATE 命令同样的格式扩展到当前日期。</p>
<p><code>%TIME%</code> - 用跟 TIME 命令同样的格式扩展到当前时间。</p>
<p><code>%RANDOM%</code> - 扩展到 0 和 32767 之间的任意十进制数字。</p>
<p><code>%ERRORLEVEL%</code> - 扩展到当前 ERRORLEVEL 数值。</p>
<p><code>%CMDEXTVERSION%</code> - 扩展到当前命令处理器扩展版本号。</p>
<p><code>%CMDCMDLINE%</code> - 扩展到调用命令处理器的原始命令行。</p>
<p><code>%HIGHESTNUMANODENUMBER%</code> - 扩展到此计算机上的最高 NUMA 节点号。</p>
<p><code>%~dp0</code> - 代表的是脚本文件在磁盘的位置</p>
<p><code>%~dpI</code> - 第I个文件路径参数的完整父级路径</p>
<p><code>%~nxI</code> - 第I个文件路径参数的文件名（包括扩展名）</p>
<p><code>%~nI</code> - 第I个文件路径参数的文件名（不包括扩展名）</p>
<h3 id="命令">命令</h3>
<ul>
<li>
<p><strong>ECHO</strong>：显示信息，或将命令回显打开或关上。</p>
<ul>
<li>
<p><strong>ECHO [ON | OFF]</strong>：<code>echo on</code>表示打开回显，<code>echo off</code>表示关闭回显</p>
<blockquote>
<p>要显示当前回显设置，键入不带参数的 ECHO。</p>
</blockquote>
</li>
<li>
<p><strong>ECHO [message]</strong>：显示后面的信息，也可以输出文件</p>
</li>
<li>
<p>使用<code>@</code>会使当前行的命令不回显</p>
</li>
</ul>
</li>
<li>
<p><strong>PAUSE</strong>：暂停批处理程序，并显示消息：<strong>请按任意键继续. . .</strong></p>
</li>
<li>
<p><strong>CLS</strong>：清除屏幕</p>
</li>
<li>
<p><strong>REM</strong>：在批处理文件或 CONFIG.SYS 里加上<strong>注释</strong></p>
<ul>
<li>
<p><strong>REM [comment]</strong></p>
<blockquote>
<p>可以用&quot;::&ldquo;代替&quot;REM&rdquo;，可以提高执行速度，不过REM的兼容性更好,我还是建议大家用rem注释</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p><strong>SET</strong>：给变量赋值(撤销)</p>
<ul>
<li>
<p><code>set &lt;变量名&gt;=&lt;值&gt;</code>：当值为<strong>空</strong>时，例如<code>set a=</code>，此时使用<code>echo a</code> 的结果和<code>echo </code>相同。</p>
</li>
<li>
<p><code>set /p &lt;变量名&gt;=&lt;comment&gt;</code>：等待用户输入数据，会显示<code>&lt;comment&gt;</code>的内容</p>
</li>
<li>
<p><code>set /a &lt;变量名&gt;=&lt;表达式&gt;</code>：计算，会计算<code>&lt;表达式&gt;</code>的内容再赋值给变量</p>
<blockquote>
<p>批处理能处理的数字不能超过32位</p>
</blockquote>
</li>
<li>
<p><code>( )</code>： 分组</p>
<p><code>! ~ -</code>：一元运算符</p>
<p><code>\ * / %</code>：算数运算符</p>
<p><code>+ -</code>：算数运算符</p>
<p><code>&lt;&lt; &gt;&gt;</code>：逻辑移位</p>
<p><code>-</code>按位“与”</p>
<p><code>^</code>按位“异”</p>
<p><code>|</code>：按位“或”</p>
<p><code>= \*= /= %= += -=</code>：赋值</p>
<p><code>&amp;= ^= |= &lt;&lt;= &gt;&gt;=</code></p>
<p><code>,</code>：表达式隔符</p>
<p><code>set /a</code>支持多行表达式并列，比如<code>set /a num1=1+1,num2=1+2,num3=1+3</code></p>
<p>并且<code>set /a</code>不需要扩展变量,比如<code>set /a num=%num2%+%num3%</code>与<code>set /a num=num2+num3</code>等价</p>
</li>
</ul>
</li>
<li>
<p><strong>xcopy</strong>：用于复制文件和目录的命令。<code>xcopy &lt;source&gt; &lt;destination&gt; /E /C /H /R /Y</code></p>
<p><code>/E</code>表示复制目录和子目录；<code>/C</code>表示继续复制，即使出现错误，
<code>/H</code>表示复制隐藏文件；<code>/R</code>表示覆盖只读文件，
<code>/Y</code>表示在不提示的情况下覆盖现有文件。</p>
</li>
<li>
<p><code>call &lt;filename&gt;</code> 调用外部bat文件</p>
</li>
<li>
<p><code>cmd /k</code> 是执行完<code>dir</code>命令后不关闭命令窗口</p>
</li>
<li>
<p><code>start &lt;filename&gt;</code> 启动另一个窗口来运行指定的程序或命令。</p>
</li>
<li>
<p><strong>||和&amp;&amp;的用法</strong>：</p>
<ul>
<li>使用<code>&amp;&amp;</code>连接的两条命令，当第一条执行成功之后（<code>%ERRORLEVEL%</code>是0），紧接着会执行第二条命令。</li>
<li><code>||</code>则相反，当第一条命令执行失败后，执行第二条命令。</li>
<li>也可以把这两个技巧结合起来使用，通过<code>()</code>来构造</li>
</ul>
</li>
<li>
<p><strong>EXIT</strong>：退出。<code>EXIT [/B] [exitCode]</code></p>
<ul>
<li><code>/B</code>     指定要退出当前批处理脚本而不是 CMD.EXE。如果从一个批处理脚本外执行，则会退出 CMD.EXE</li>
<li><strong>exitCode</strong> 指定一个数字号码。如果指定了 /B，将 <strong>ERRORLEVEL</strong> 设成那个数字。如果退出 CMD.EXE，则用那个数字设置过程退出代码。</li>
</ul>
</li>
</ul>
<h3 id="字符串操作">字符串操作</h3>
<p><strong>拼接</strong>：直接放一起</p>
<pre tabindex="0"><code>set aa=aabbcc
set bb=ddeeff
echo %aa%%bb%
</code></pre><p><strong>截取</strong></p>
<pre tabindex="0"><code>set testStr=abcdefghijklmnopqrstuvwxyz0123456789
echo 原始字符串 %testStr%
echo 提取前五个字符串：%testStr:~0,5%
echo 提取最后五个字符串：%testStr:~-5%
echo 提取第一个到倒数第六个字符串：%testStr:~0,-5%
echo 提取五个字符串，从第四个字符开始:%testStr:~3,5%
</code></pre><p><strong>替换</strong></p>
<pre tabindex="0"><code>set repStr=aaabbbaacccdddeeefff
echo 替换之前:%repStr%
echo 替换后：%repStr:aa=zz%
#结果 repStr=zzabbbzzcccdddeeefff
</code></pre><p>替换是从字符串左边开始一个一个判断的，判断成功则替换</p>
<h3 id="命令列表">命令列表</h3>
<pre tabindex="0"><code>ASSOC  显示或修改文件扩展名关联。
AT    计划在计算机上运行的命令和程序。
ATTRIB  显示或更改文件属性。
BREAK  设置或清除扩展式 CTRL+C 检查。
CACLS  显示或修改文件的访问控制列表(ACLs)。
CALL   从另一个批处理程序调用这一个。
CD    显示当前目录的名称或将其更改。
CHCP   显示或设置活动代码页数。
CHDIR  显示当前目录的名称或将其更改。
CHKDSK  检查磁盘并显示状态报告。
CHKNTFS 显示或修改启动时间磁盘检查。
CLS   清除屏幕。
CMD   打开另一个 Windows 命令解释程序窗口。
COLOR  设置默认控制台前景和背景颜色。
COMP   比较两个或两套文件的内容。
COMPACT 显示或更改 NTFS 分区上文件的压缩。
CONVERT 将 FAT 卷转换成 NTFS。您不能转换当前驱动器。
COPY   将至少一个文件复制到另一个位置。
DATE   显示或设置日期。
DEL   删除至少一个文件。
DIR   显示一个目录中的文件和子目录。
DISKCOMP 比较两个软盘的内容。
DISKCOPY 将一个软盘的内容复制到另一个软盘。
DOSKEY  编辑命令行、调用 Windows 命令并创建宏。
ECHO   显示消息，或将命令回显打开或关上。
ENDLOCAL 结束批文件中环境更改的本地化。
ERASE  删除至少一个文件。
EXIT   退出 CMD.EXE 程序(命令解释程序)。
FC    比较两个或两套文件，并显示不同处。
FIND   在文件中搜索文字字符串。
FINDSTR 在文件中搜索字符串。
FOR   为一套文件中的每个文件运行一个指定的命令。
FORMAT  格式化磁盘，以便跟 Windows 使用。
FTYPE  显示或修改用于文件扩展名关联的文件类型。
GOTO   将 Windows 命令解释程序指向批处理程序中某个标明的行。
GRAFTABL 启用 Windows 来以图像模式显示扩展字符集。
HELP   提供 Windows 命令的帮助信息。
IF    执行批处理程序中的条件性处理。
LABEL  创建、更改或删除磁盘的卷标。
MD    创建目录。
MKDIR  创建目录。
MODE   配置系统设备。
MORE   一次显示一个结果屏幕。
MOVE   将文件从一个目录移到另一个目录。
PATH   显示或设置可执行文件的搜索路径。
PAUSE  暂停批文件的处理并显示消息。
POPD   还原 PUSHD 保存的当前目录的上一个值。
PRINT  打印文本文件。
PROMPT  更改 Windows 命令提示符。
PUSHD  保存当前目录，然后对其进行更改。
RD  删除目录。
RECOVER 从有问题的磁盘恢复可读信息。
REM   记录批文件或 CONFIG.SYS 中的注释。
REN   重命名文件。
RENAME  重命名文件。
REPLACE 替换文件。
RMDIR  删除目录。
SET   显示、设置或删除 Windows 环境变量。
SETLOCAL 开始批文件中环境更改的本地化。
SHIFT  更换批文件中可替换参数的位置。
SORT   对输入进行分类。
START  启动另一个窗口来运行指定的程序或命令。
SUBST  将路径跟一个驱动器号关联。
TIME   显示或设置系统时间。
TITLE  设置 CMD.EXE 会话的窗口标题。
TREE   以图形模式显示驱动器或路径的目录结构。
TYPE   显示文本文件的内容。
VER   显示 Windows 版本。
VERIFY  告诉 Windows 是否验证文件是否已正确写入磁盘。
VOL   显示磁盘卷标和序列号。
XCOPY  复制文件和目录树。
</code></pre>
    </div>
    <div class="post-footer">
        <div class="info">
            
            
        </div>
        


    </div>
    
        
    
</div>

                <div class="grow"></div>
                <div class="built-with">
    Built with <a href="https://gohugo.io/">Hugo</a> <b>·</b> Using the <a href="https://github.com/LucasVadilho/heyo-hugo-theme">heyo</a> theme
</div>
            </div>
        </div>
        
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha512-3M00D/rn8n+2ZVXBO9Hib0GKNpkm8MSUU/e2VNthDyBYxKWG+BftNYYcuEjXlyrSO637tidzMBXfE7sQm0INUg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<script type="text/javascript">
            
            
            window.MathJax = {
                tex: {
                    inlineMath: [['$', '$'], ['\\(', '\\)']],
                    displayMath: [['$$','$$'], ['\\[', '\\]']]
                },
                svg: {
                    scale: 1.25,
                }
            };
        </script><script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.0/es5/tex-mml-svg.min.js" integrity="sha512-/mL9Gs6E5Bz6NtPOr9eY&#43;T8IIdJbo2JL3TudApzFFelwBXEc3TeFLU6kPq122TJROv7jkktuBRkz5h8vGzrsyA==" crossorigin="anonymous"></script>
    </body>
</html>